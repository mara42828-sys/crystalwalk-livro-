% preambulo.tex — Preambulo do CrystalWalk
% NÃO INCLUIR \documentclass aqui! Deve estar apenas no main.tex

% --- Página e margens ---
\usepackage[paperwidth=16cm,paperheight=23cm,top=2.5cm,bottom=2.5cm,inner=2.5cm,outer=2cm]{geometry}

% --- Codificação e fontes ---
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage[brazil]{babel}

% --- Utilitários ---
\usepackage{microtype}
\usepackage{setspace}
\usepackage{titlesec}
\usepackage{titling}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{calc}
\usepackage{hyperref}
\usepackage{tocloft}
\usepackage{csquotes}
\usepackage{enumitem}
\usepackage{booktabs}
\usepackage{xcolor}
\usepackage{eso-pic}
\usepackage{everypage}
\usepackage{tcolorbox} % caixas para quizzes e planos
\usepackage{multicol}
\usepackage{pdfpages}  % para incluir PDF no apêndice
\usepackage{amssymb,amsmath}

% --- Cores ---
\definecolor{crystalblue}{RGB}{12,59,81}       % fundo principal
\definecolor{crystalblue2}{RGB}{29,88,109}     % tom alternativo
\definecolor{crystalaccent}{RGB}{220,235,242}  % tom claro para linhas

% --- Formatação de capítulos ---
\titleformat{\chapter}[display]
  {\normalfont\bfseries\Huge}
  {\filcenter\MakeUppercase{\chaptername\ \thechapter}}
  {1ex}
  {\filcenter}
\titlespacing*{\chapter}{0pt}{-10pt}{20pt}

% --- Cabeçalho / Rodapé limpos ---
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

% --- Ambientes práticos ---
\newtcolorbox{lessonplan}[1][]{
  colback=crystalaccent!5!white,
  colframe=crystalblue2!50!black,
  left=6pt, right=6pt, top=6pt, bottom=6pt,
  title=Plano de Aula,
  fonttitle=\bfseries,
  #1
}

\newtcolorbox{quizbox}[1][]{
  colback=white,
  colframe=crystalblue2!60!black,
  left=6pt, right=6pt, top=6pt, bottom=6pt,
  title=Quiz,
  fonttitle=\bfseries,
  #1
}

% --- Comando para passos em CrystalWalk ---
\newcommand{\cwstep}[1]{\vspace{0.4em}\noindent\textbf{Passo:} #1 \par}

% --- Bordas e numeração lateral (opcional) ---
\makeatletter
\AddEverypageHook{%
  \begin{tikzpicture}[remember picture,overlay]
    \foreach \y in {2,6,10,14,18,22} {
      \draw[opacity=0.06,color=crystalaccent] ($(current page.north west)+(0.6cm,-\y mm)$) -- ++(1.4cm,-6mm);
    }
    \begin{scope}[shift={(current page.south west)}, x=1cm, y=1cm]
      \foreach \i/\j in {(1,1),(2,1.6),(0.6,2.8),(1.8,3.6)} {
        \fill[opacity=0.04,color=crystalaccent] \i circle (0.06cm);
      }
      \draw[opacity=0.02,color=crystalblue2] (1,1) -- (2,1.6) -- (1.8,3.6);
    \end{scope}
  \end{tikzpicture}%
}
\makeatother

\makeatletter
\AddToShipoutPictureBG{%
  \begin{tikzpicture}[remember picture,overlay]
    \node[anchor=east, rotate=90, text=crystalaccent!85!white, font=\footnotesize]
      at ($(current page.east)+(0cm,-0.5\paperheight)$) {\thepage};
  \end{tikzpicture}%
}
\makeatother
